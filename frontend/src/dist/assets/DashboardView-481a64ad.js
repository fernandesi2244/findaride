import{A as j}from"./AddTripForm-861795ce.js";import{_ as A,e as c}from"./index-9e0a4d45.js";import{g as u,k as B,l as m,m as O,o as i,c as l,a as e,t as a,F as b,n as T,q as N,s as E,d as r,p as J,i as P,b as U}from"./vendor-1c2b7f9b.js";u.defaults.xsrfCookieName="csrftoken";u.defaults.xsrfHeaderName="X-CSRFTOKEN";const o=_=>(J("data-v-335ae099"),_=_(),P(),_),G={class:"dashboard"},H={class:"trips-section"},K=o(()=>e("div",{class:"section-header"},[e("h2",null,"Your Trips")],-1)),M={key:0},W={class:"list-reset"},X=["onClick"],z={class:"trip-info"},Q=o(()=>e("strong",null,"From:",-1)),Z=o(()=>e("strong",null,"To:",-1)),ee=o(()=>e("strong",null,"Departure Date:",-1)),te=o(()=>e("strong",null,"Departure Time:",-1)),se=o(()=>e("strong",null,"Luggage Count:",-1)),ne=o(()=>e("strong",null,"Comments:",-1)),oe={key:0},ae=o(()=>e("strong",null,"Name:",-1)),re=o(()=>e("strong",null,"Departure Time:",-1)),ie=o(()=>e("strong",null,"Luggage Count:",-1)),le={key:1},de=o(()=>e("p",{class:"no-trips-message"},"You haven't planned any trips yet.",-1)),ue=[de],ce={class:"section-header"},_e=o(()=>e("h2",null,"Your Trip Requests",-1)),pe={key:2},ge={class:"list-reset"},he={class:"trip-info"},me=o(()=>e("strong",null,"From:",-1)),ve=o(()=>e("strong",null,"To:",-1)),fe=o(()=>e("strong",null,"Departure Date:",-1)),ye=o(()=>e("strong",null,"Departure Time:",-1)),ke=o(()=>e("strong",null,"Luggage Count:",-1)),Ce=o(()=>e("strong",null,"Comments:",-1)),be=["onClick"],Te={key:3},$e=o(()=>e("p",{class:"no-trips-message"},"You haven't planned any trips yet.",-1)),De=[$e],xe=o(()=>e("div",{class:"section-header"},[e("h2",null,"Your Confirmation Requests")],-1)),Ne={key:4},we={class:"list-reset"},Se={class:"trip-info"},Fe=o(()=>e("strong",null,"Group:",-1)),Ie=o(()=>e("strong",null,"Date:",-1)),Le=o(()=>e("strong",null,"From:",-1)),Re=o(()=>e("strong",null,"To:",-1)),qe=o(()=>e("strong",null,"Departure Time:",-1)),Ye=o(()=>e("strong",null,"Luggage Count:",-1)),Ve=["onClick"],je=["onClick"],Ae={key:5},Be=o(()=>e("p",{class:"no-trips-message"},"You haven't planned any trips yet.",-1)),Oe=[Be],Ee={__name:"Dashboard",setup(_){const p=B({first_name:"",id:-1}),v=m([]),g=m([]),h=m([]);O(async()=>{await F(),await y(),await $()});const f=m(!1);m([]);function w(s){showTrip.value=!0,displayedTrip.value=s}async function S(s){let n={address:s.from,postal_code:s.fromPostalCode},t={address:s.to,postal_code:s.toPostalCode},q={departure_time:`${s.departureDate.substring(2)} ${s.departureTime}:00`,num_luggage_bags:s.luggageCount,user:p.id,departure_location:n,arrival_location:t};const Y=c.tripRequest;try{await u.post(Y,q)}catch(V){alert(C(V.response.data.error));return}f.value=!1,y()}async function F(){const s=c.me,n=await u.get(s);Object.assign(p,n.data)}async function y(){const s=`${c.userTrips}${p.id}/`,n=await u.get(s);g.value=n.data.trip_requests,v.value=n.data.trips}async function $(){const s=`${c.confirmationRequests}`,n=await u.get(s);h.value=n.data}async function I(s){const n=g.value.findIndex(t=>t.id===s);if(n!==-1){const t=`${c.deleteTripRequest}${s}/`;try{u.delete(t),g.value.splice(n,n+1)}catch(d){alert(C(d.response.data.error));return}}}function L(s){if(h.findIndex(t=>t.id===s)!==-1){const t=`${c.confirmationRequest}${s}/accept/`;try{u.delete(t),y(),$()}catch(d){alert(C(d.response.data.error));return}}}function R(s){if(h.findIndex(t=>t.id===s)!==-1){const t=`${c.confirmationRequest}${s}/reject/`;try{u.delete(t),y(),$()}catch(d){alert(C(d.response.data.error));return}}}function D(s){return new Date(s).toLocaleDateString()}function x(s){return new Date(s).toLocaleTimeString()}function k(s){let n=s.split(",");return n.splice(-1),n.join(",")}function C(s){if(typeof s=="string")return s;try{let n="";for(const[t,d]of Object.entries(s))n+=`${d}
`;return n}catch{return JSON.stringify(s)}}return(s,n)=>(i(),l("div",G,[e("h1",null,"Welcome back, "+a(p.first_name)+"!",1),e("div",H,[K,v.value.length?(i(),l("div",M,[e("ul",W,[(i(!0),l(b,null,T(v.value,t=>(i(),l("li",{key:t.id,class:"card"},[e("button",{onClick:d=>w(t)},[e("div",z,[e("div",null,[Q,r(" "+a(k(t.departure_location)),1)]),e("div",null,[Z,r(" "+a(k(t.arrival_location)),1)]),e("div",null,[ee,r(" "+a(D(t.departure_time)),1)]),e("div",null,[te,r(" "+a(x(t.departure_time)),1)]),e("div",null,[se,r(" "+a(t.num_luggage_bags),1)]),e("div",null,[ne,r(" "+a(t.comments),1)])])],8,X)]))),128)),s.showTrip?(i(),l("div",oe,[(i(!0),l(b,null,T(s.displayedTrip.joinRequests,t=>(i(),l("li",{key:t.id,class:"card"},[e("div",null,[ae,r(" "+a(t.name),1)]),e("div",null,[re,r(" "+a(t.departureTime),1)]),e("div",null,[ie,r(" "+a(t.luggageCount),1)])]))),128))])):N("",!0)])])):(i(),l("div",le,ue)),e("div",ce,[_e,e("button",{onClick:n[0]||(n[0]=t=>f.value=!0),class:"btn add-trip-btn"},"+ Add New Trip Request")]),g.value.length?(i(),l("div",pe,[e("ul",ge,[(i(!0),l(b,null,T(g.value,t=>(i(),l("li",{key:t.id,class:"card"},[e("div",he,[e("div",null,[me,r(" "+a(k(t.departure_location)),1)]),e("div",null,[ve,r(" "+a(k(t.arrival_location)),1)]),e("div",null,[fe,r(" "+a(D(t.departure_time)),1)]),e("div",null,[ye,r(" "+a(x(t.departure_time)),1)]),e("div",null,[ke,r(" "+a(t.num_luggage_bags),1)]),e("div",null,[Ce,r(" "+a(t.comments),1)])]),e("button",{onClick:d=>I(t.id),class:"btn btn-danger"},"Remove",8,be)]))),128))])])):(i(),l("div",Te,De)),xe,h.value.length?(i(),l("div",Ne,[e("ul",we,[(i(!0),l(b,null,T(h.value,t=>(i(),l("li",{key:t.id,class:"card"},[e("div",Se,[e("div",null,[Fe,r(" "+a(t.groupName),1)]),e("div",null,[Ie,r(" "+a(t.trip.date),1)]),e("div",null,[Le,r(" "+a(t.trip.from),1)]),e("div",null,[Re,r(" "+a(t.trip.to),1)]),e("div",null,[qe,r(" "+a(t.trip.departureTime),1)]),e("div",null,[Ye,r(" "+a(t.trip.luggageCount),1)])]),e("button",{onClick:d=>L(t.id),class:"btn btn-primary"},"Join",8,Ve),e("button",{onClick:d=>R(t.id),class:"btn btn-danger"},"Reject",8,je)]))),128))])])):(i(),l("div",Ae,Oe))]),f.value?(i(),E(j,{key:0,onAddTripRequest:S,onClose:n[1]||(n[1]=t=>f.value=!1)})):N("",!0)]))}},Je=A(Ee,[["__scopeId","data-v-335ae099"]]),He={__name:"DashboardView",setup(_){return(p,v)=>(i(),l("main",null,[U(Je)]))}};export{He as default};
